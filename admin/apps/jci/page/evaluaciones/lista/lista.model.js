"use strict";var cargarURL=function(){fetch("../config.json").then((e=>e.json())).then((e=>{window.host=e.URL,KTPersonalList.init()})).catch((e=>{console.error("Error al cargar el archivo JSON:",e)}))},KTPersonalList=function(){var e,t,a,n,s,i,r,o=function(){(n=$("#tb_periodos").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,select:{style:"single",toggleable:!1},order:[[1,"desc"]],stateSave:!1,ajax:{type:"POST",url:`${window.host}/API/jci/periodos/lista`,data:function(e){$.extend(e,{fecinicio:"",estado:"",usuario:$("#session_usuario_id").val(),usuario_rol:$("#session_rol_id").val()})}},columnDefs:[{targets:0,visible:!0,render:function(e,t,a){return`                        \n                      <span class="fw-bold fs-6">${e}</span>                      \n                    `}},{targets:1,visible:!0},{targets:2,visible:!0},{targets:3,visible:!0,render:function(e,t,a){return`\n                      <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${e}</div>\n                    `}},{targets:4,visible:!0},{targets:5,visible:!0}]})).on("draw.dt",(function(){n.row(":eq(0)").select()})),n.$,$("#tb_periodos").on("dblclick","tr",(function(e,t,a,n){$("#tb_periodos").DataTable().row(this).data();var i=document.getElementById("div-periodos"),r=document.getElementById("div-servicios");i.classList.contains("d-none")?(i.classList.remove("d-none"),r.classList.add("d-none")):(i.classList.add("d-none"),r.classList.remove("d-none")),(s=$("#tb_servicios").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,order:[[1,"asc"]],select:{style:"single",toggleable:!1},stateSave:!1,ajax:{type:"POST",url:`${window.host}/API/jci/servicios/lista`,data:function(e){$.extend(e,{periodo:$("#tb_periodos").DataTable().row(".selected").data()[0],estado:"",usuario:$("#session_usuario_id").val(),usuario_rol:$("#session_rol_id").val()})}},columnDefs:[{targets:0,visible:!1,render:function(e,t,a){return`                        \n                    <span class="fw-bold fs-6">${e}</span>                      \n                  `}},{targets:1,visible:!0},{targets:2,visible:!0,render:function(e,t,a){return`\n                    <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${e}</div>\n                  `}},{targets:3,visible:!0},{targets:4,visible:!0}]})).on("draw",(function(){$('[data-bs-toggle="tooltip"]').tooltip(),KTMenu.createInstances(),l()})),s.on("draw.dt",(function(){s.row(":eq(0)").select()}))})),$("#tb_servicios").on("dblclick","tr",(function(e,t,a,n){$("#tb_servicios").DataTable().row(this).data();var s=document.getElementById("div-servicios"),r=document.getElementById("div-personal");s.classList.contains("d-none")?(s.classList.remove("d-none"),r.classList.add("d-none")):(s.classList.add("d-none"),r.classList.remove("d-none")),(i=$("#tb_personal").DataTable({searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,order:[[2,"asc"]],stateSave:!1,ajax:{type:"POST",url:`${window.host}/API/jci/encuestas/lista`,data:function(e){$.extend(e,{servicio:$("#tb_servicios").DataTable().row(".selected").data()[0],usuario:$("#session_usuario_id").val(),usuario_rol:$("#session_rol_id").val(),periodo:$("#tb_periodos").DataTable().row(".selected").data()[0]})}},columnDefs:[{targets:0,visible:!1},{targets:1,visible:!1},{targets:2,visible:!1},{targets:3,visible:!0,className:"d-flex align-items-center",render:function(e,t,a){var n=a[2];if("blank.png"!=n)var s='<div class=symbol-label><img src="assets/media/avatars/'+n+'" alt="Avatar" class="w-100"></div>';else{var i=["success","danger","warning","info","dark","primary","secondary"][Math.floor(6*Math.random())],r=e.match(/\b\w/g)||[];s='<div class="symbol-label fs-3 bg-light-'+i+" text-"+i+'">'+(r=((r.shift()||"")+(r.pop()||"")).toUpperCase())+"</div>"}return`                        \n                      \x3c!--begin:: Avatar --\x3e\n                      <div class="symbol symbol-circle symbol-50px overflow-hidden me-3">\n                        <a href="/good/apps/user-management/users/view.html">\n                            ${s}\n                        </a>\n                      </div>\n                      \x3c!--end::Avatar--\x3e\n\n                      \x3c!--begin::User details--\x3e\n                      <div class="d-flex flex-column">\n                        <a href="#!" class="text-gray-800 text-hover-primary mb-1" data-bs-toggle="tooltip" title="Haga click aquí para cerrar su sesión">${e}</a>\n                        <span>${a[4]}</span>\n                      </div>\n                      \x3c!--end::User details--\x3e                        \n                    `}},{targets:4,visible:!1},{targets:5,visible:!1},{targets:6,visible:!0,render:function(e,t,a){return`                        \n                      \x3c!--begin::Flag--\x3e\n                      <img src="assets/media/flags/${a[7]}" class="w-25px me-3" style="width: 20px;border-radius: 4px" alt="" />\n                      \x3c!--end::Flag--\x3e\n                      <span class="text-dark fw-bold fs-7">${e}</span>                      \n                    `}},{targets:7,visible:!1},{targets:8,visible:!1},{targets:9,visible:!0,render:function(e,t,a){return`\n                      <div class="badge badge-light-${"100.0"==e?"success":"danger"} fw-bold">${e}%</div>\n                    `}},{targets:10,visible:!1},{targets:11,visible:!1},{targets:12,visible:!0,render:function(e,t,a){return`\n                      <div class="badge badge-light-primary fw-bold" ${"100.0"!=e?'data-bs-toggle="tooltip" data-bs-placement="top" title="Debe terminar la evaluación para ver la nota"':""}>${"100.0"!=e?"--":e} / 100</div>\n                    `}},{targets:13,visible:!1},{targets:14,visible:!1},{targets:15,visible:!1,render:function(e,t,a){return`\n                      <div class="badge badge-light-${"ACTIVO"==e?"success":"danger"} fw-bold">${1==e?"ACTIVO":"INACTIVO"}</div>\n                    `}},{targets:16,visible:!0},{targets:17,visible:!0},{targets:-1,visible:!0,data:null,orderable:!1,className:"text-end",render:function(e,t,a){return`\n                      <a href="#" class="btn btn-light btn-active-light-primary btn-sm" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end" data-kt-menu-flip="top-end">                                \n                        <span class="svg-icon svg-icon-5 m-0">\n                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">\n                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                                  <polygon points="0 0 24 0 24 24 0 24"></polygon>\n                                  <path d="M6.70710678,15.7071068 C6.31658249,16.0976311 5.68341751,16.0976311 5.29289322,15.7071068 C4.90236893,15.3165825 4.90236893,14.6834175 5.29289322,14.2928932 L11.2928932,8.29289322 C11.6714722,7.91431428 12.2810586,7.90106866 12.6757246,8.26284586 L18.6757246,13.7628459 C19.0828436,14.1360383 19.1103465,14.7686056 18.7371541,15.1757246 C18.3639617,15.5828436 17.7313944,15.6103465 17.3242754,15.2371541 L12.0300757,10.3841378 L6.70710678,15.7071068 Z" fill="currentColor" fill-rule="nonzero" transform="translate(12.000003, 11.999999) rotate(-180.000000) translate(-12.000003, -11.999999)"></path>\n                                </g>\n                            </svg>\n                        </span>\n                      </a>\n                      \x3c!--begin::Menu--\x3e\n                      <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-125px py-4" data-kt-menu="true">\n                        \x3c!--begin::Menu item--\x3e\n                        <div class="menu-item px-3">\n                          <a href="?app=jci&page=evaluaciones/nuevo&periodo=${a[8]}&servicio=${a[5]}&colaborador=${a[1]}" class="menu-link px-3" data-kt-customer-table-filter="edit_row">\n                            Editar\n                          </a>\n                        </div>\n                        \x3c!--end::Menu item--\x3e\n\n                        \x3c!--begin::Menu item--\x3e\n                        <div class="menu-item px-3">\n                          <a href="#" class="menu-link px-3" data-kt-customer-table-filter="delete_row">\n                            Eliminar\n                          </a>\n                        </div>\n                        \x3c!--end::Menu item--\x3e\n                      </div>\n                      \x3c!--end::Menu--\x3e\n                    `}}]})).on("draw",(function(){$('[data-bs-toggle="tooltip"]').tooltip(),KTMenu.createInstances(),l()}))})),n.on("draw",(function(){KTMenu.createInstances()}))},l=function(){document.querySelector('[data-kt-colaborador-table-filter="search"]').addEventListener("keyup",(function(e){i.search(e.target.value).draw()}))};return{init:function(){a=document.getElementById("kt_periodo_filtro_form"),t=document.getElementById("kt_periodo_filtro_submit"),document.getElementById("kt_periodo_filtro_cancel"),r={fecinicio:"",estado:"",usuario:$("#session_usuario_id").val()},o(),document.querySelector('[data-kt-customer-table-filter="search"]').addEventListener("keyup",(function(e){n.search(e.target.value).draw()})),e=FormValidation.formValidation(a,{fields:{estado:{validators:{callback:{message:"Debe seleccionar un estado válido",callback:function(e){var t=e.value;return"1"===t||"0"===t||""===t}}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),t.addEventListener("click",(a=>{a.preventDefault(),e&&e.validate().then((function(e){"Valid"==e?(t.setAttribute("data-kt-indicator","on"),t.disabled=!0,r.fecinicio=$("form#kt_periodo_filtro_form [name='fecha']").val(),r.estado=$("form#kt_periodo_filtro_form [name='estado']").val(),setTimeout((function(){r.estado="x",n.ajax.params({fecinicio:"",estado:"0",usuario:2}),n.ajax.reload(null,!1)}),500)):Swal.fire({html:"Lo siento, se han detectado campos <strong>obligatorios</strong> pendientes de llenado",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, entendido",customClass:{confirmButton:"btn btn-primary"}})}))}))}}}();function ObtenerDatosEncuesta(){var e=new Array;return e.usuario=$("#nombres").val(),e.periodo=$("#rol").val(),e.estado=""===$("#estado_col").val()?null:$("#estado_col").val(),e}KTUtil.onDOMContentLoaded((function(){cargarURL()})),$("form#kt_periodo_filtro_form [name=fecha]").flatpickr({altInput:!0,altFormat:"d/m/Y",dateFormat:"Y-m-d",mode:"range",locale:"es"});